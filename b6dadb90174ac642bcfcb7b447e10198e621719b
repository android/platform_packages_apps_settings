{
  "comments": [
    {
      "key": {
        "uuid": "c76c6f5c_75f709f2",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 405,
      "author": {
        "id": 1124543
      },
      "writtenOn": "2019-09-25T20:15:52Z",
      "side": 1,
      "message": "This code also does not respect devices in single-SIM mode (i.e. phoneCount \u003d\u003d 1) where there are both pSIM and eSIM slots, but only one can be active at a time.\n\nThis case still needs to be accounted for using the old logic.",
      "range": {
        "startLine": 405,
        "startChar": 17,
        "endLine": 405,
        "endChar": 26
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6f7a319f_423741bd",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 405,
      "author": {
        "id": 1163305
      },
      "writtenOn": "2019-09-26T07:25:49Z",
      "side": 1,
      "message": "Would you please let me understand what is wrong in that scenario? My understanding is that only one preference for SIM status exists on \"About phone\" screen if getPhoneCount() returns 1.\n\n    @Override\n    public void displayPreference(PreferenceScreen screen) {\n    ...\n        mPreferenceList.add(preference);\n\n        final int simStatusOrder \u003d preference.getOrder();\n        // Add additional preferences for each sim in the device\n        for (int simSlotNumber \u003d 1; simSlotNumber \u003c mTelephonyManager.getPhoneCount();\n                simSlotNumber++) {\n    ...\n            mPreferenceList.add(multiSimPreference);\n        }\n    }\n\nOnly one instance of SimStatusDialogController is created with the available logical slot number, then it should be associated with the available physical slot number.",
      "parentUuid": "c76c6f5c_75f709f2",
      "range": {
        "startLine": 405,
        "startChar": 17,
        "endLine": 405,
        "endChar": 26
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "536ea98a_24e347dd",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 405,
      "author": {
        "id": 1124543
      },
      "writtenOn": "2019-09-26T16:44:44Z",
      "side": 1,
      "message": "Correct about just one Controller instance with phoneId 0, but consider example of Pixel 2 or 3, which has 2 slots, but only one can be active.\n\nMany carriers require that EID is visible prior to activation, but some phones cannot return EID in the IccSlotStatus returned from the modem. This change is not accounting for those devices, and so they may start failing carrier TA.\n\nOn Pixel 2, it does not support the IRadio/IRadioConfig HALs new enough to return 2 Uicc{Slot,Card}Info instances from TelephonyManager, and can only return 1 for the active slot. On Pixel 3, it has a HAL new enough to return 2 Uicc{Slot,Card}Info instances from TelMan, but EID is not available from those objects unless the eSIM slot is currently active. In both of these cases, the LPA may have a cached EID value available for the eSIM, which is accessible via EuiccManager#getEid.\n\nIn general, it\u0027s fine to check Uicc{Slot,Card}Info first, but if that doesn\u0027t contain EID, EuiccManager (\u003d\u003d the LPA) should be the next source of truth to check.",
      "parentUuid": "6f7a319f_423741bd",
      "range": {
        "startLine": 405,
        "startChar": 17,
        "endLine": 405,
        "endChar": 26
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2a646e6b_f7a97392",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 409,
      "author": {
        "id": 1124543
      },
      "writtenOn": "2019-09-25T18:27:30Z",
      "side": 1,
      "message": "mSlotId is a logical slot ID \u003d\u003d phoneId, not a physical slot ID\n\nYou need to use UiccSlotInfo to convert logical slot -\u003e physical slot, then UiccCardInfo to convert physical slot -\u003e card ID, then you can get EID",
      "range": {
        "startLine": 409,
        "startChar": 55,
        "endLine": 409,
        "endChar": 62
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "52a6e3ae_fbd314b2",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 409,
      "author": {
        "id": 1163305
      },
      "writtenOn": "2019-09-26T07:25:49Z",
      "side": 1,
      "message": "Thanks for your review. As you mentioned, I have not considered the slot mapping in the previous patch set. Please check the patch set 5 as I considered it in the test code also.",
      "parentUuid": "2a646e6b_f7a97392",
      "range": {
        "startLine": 409,
        "startChar": 55,
        "endLine": 409,
        "endChar": 62
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "fb7ec38e_39ec91dc",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 414,
      "author": {
        "id": 1124543
      },
      "writtenOn": "2019-09-25T20:16:38Z",
      "side": 1,
      "message": "else call EuiccManager#createForCardId(info.getCardId()).getEid() and check if that\u0027s valid",
      "range": {
        "startLine": 414,
        "startChar": 20,
        "endLine": 414,
        "endChar": 21
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b0306e7_f455b33f",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 414,
      "author": {
        "id": 1163305
      },
      "writtenOn": "2019-09-26T07:25:49Z",
      "side": 1,
      "message": "Thanks for your comment. I would like to know why it must be added here in more detail.",
      "parentUuid": "fb7ec38e_39ec91dc",
      "range": {
        "startLine": 414,
        "startChar": 20,
        "endLine": 414,
        "endChar": 21
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5860f4d1_02cfcc5a",
        "filename": "src/com/android/settings/deviceinfo/simstatus/SimStatusDialogController.java",
        "patchSetId": 4
      },
      "lineNbr": 414,
      "author": {
        "id": 1124543
      },
      "writtenOn": "2019-09-26T16:44:44Z",
      "side": 1,
      "message": "See my other comment, but basically it\u0027s for devices on older HALs. Pixel 2 does not report EID from modem at all, and Pixel 3 can only report EID if the eSIM is active. For these cases, the LPA may be able to get EID from a cache or by some other method, so EuiccManager will call through to the LPA and see if it has a valid value.",
      "parentUuid": "3b0306e7_f455b33f",
      "range": {
        "startLine": 414,
        "startChar": 20,
        "endLine": 414,
        "endChar": 21
      },
      "revId": "b6dadb90174ac642bcfcb7b447e10198e621719b",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889",
      "unresolved": true
    }
  ]
}